<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Arab Security Cyber WarGames 2022 - Iossefy </title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta property="og:site_name" content="Iossefy"><meta property="og:locale" content="en_US"><meta property="og:url" content="/blog/arab-security-cyber-wargames-2022/"><meta property="og:site_name" content="Iossefy"><meta property="og:title" content="Arab Security Cyber WarGames 2022"><meta property="og:description" content="OSP Challenge Have you heard of OTP? This is OSP (One Secret Password).
given an osp.py that contains the following block of code.
1from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long, isPrime 2from string import printable, ascii_letters 3from secret import FLAG 4import os 5 6secret = os.urandom(len(FLAG)) 7 8def OSP(plain, secret): 9 assert len(plain) == len(secret), 'The length has to be idenntical!' 10 ct = [] 11 p = getPrime(256) 12 for f, k in zip(FLAG, secret): 13 ct.append((f * p + k)) 14 return ct, p 15 16ct, p = OSP(FLAG, secret) 17print(ct) And given a text file output.txt that contains the flag encrypted:
5447072546591309544167389173397699795993168970119080464536675615517059887871841 6955492636416595264090666175261678201037431146459748900869908862891014933743799 5614674778794119068603308840271475174331420323045821401907034865225277115190905 7290697100822214312962505509009228957713933852313230775610627362307449388382150 5949879243199738117475148174019025931007923028899303276647753364641711569829134 10307537280472785752809059512737185767802458204994567648277093857055359480126320 7290697100822214312962505509009228957713933852313230775610627362307449388382014 8715316074546095270667822677436319673589070352190528743258680984827295820594564 4357658037273047635333911338718159836794535176095264371629340492413647910297392 4609061385577261921987790839028822904301912205485375777684879366975973751276187 7961106029633452410706184176504330471066939264020194525092064361140318297658489 4106254688968833348680031838407496769287158146705152965573801617851322069318627 8547713842343285746231903010562544295250818999263787805888321735119078593275661 7961106029633452410706184176504330471066939264020194525092064361140318297658510 4106254688968833348680031838407496769287158146705152965573801617851322069318692 4609061385577261921987790839028822904301912205485375777684879366975973751276175 3268243527954785726500433504038619877595901382071448278722005369310235932723134 9637128351661547655065380845242084254449452793287603898795656858222490570849839 7961106029633452410706184176504330471066939264020194525092064361140318297658493 6536487055909571453000867008077239755191802764142896557444010738620471865445985 4022453572867428586462072004970609080118032470241782496888621992997213455659123 4609061385577261921987790839028822904301912205485375777684879366975973751276211 7961106029633452410706184176504330471066939264020194525092064361140318297658707 5363271430489904781949429339960812106824043293655709995851495990662951274212211 7961106029633452410706184176504330471066939264020194525092064361140318297658649 6704089288112380977436786674951015133530054117069637494814369988328689092765262 9553327235560142892847421011805196565280327116824233430110477233368381957190188 4106254688968833348680031838407496769287158146705152965573801617851322069318653 6452685939808166690782907174640352066022677087679526088758831113766363251786487 4273856921171642873115951505281272147625409499631893902944160867559539296637772 2765436831346357153192674503417293742581147323291225466610927620185584250765693 3771050224563214299808192504659946012610655440851671090833083118434887614680427 8547713842343285746231903010562544295250818999263787805888321735119078593275529 4022453572867428586462072004970609080118032470241782496888621992997213455659182 8547713842343285746231903010562544295250818999263787805888321735119078593275562 8547713842343285746231903010562544295250818999263787805888321735119078593275594 8128708261836261935142103843378105849405190616946935462462423610848535524977837 4273856921171642873115951505281272147625409499631893902944160867559539296637945 4525260269475857159769831005591935215132786529022005308999699742121865137616416 4441459153374452397551871172155047525963660852558634840314520117267756523956886 4609061385577261921987790839028822904301912205485375777684879366975973751276006 8463912726241880984013943177125656606081693322800417337203142110264969979616102 10475139512675595277244979179610961146140709557921308585647453106763576707445416 My approach solving the challange first thing i do is i try to collect as much information as possible from the given code. by looking at output.txt you can see that most of the lines are of length 79. while there are two lines that differs from the rest, they have the length of 80."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-08-08T12:00:00+00:00"><meta property="article:modified_time" content="2022-08-08T12:00:00+00:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Writeup"><meta property="article:tag" content="Ascwg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Arab Security Cyber WarGames 2022"><meta name=twitter:description content="iossefy's personal website/Blog."><meta name=twitter:image content="/"><link rel=canonical href=/blog/arab-security-cyber-wargames-2022/><link rel=stylesheet href=/css/site.min.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/syntax.css><link rel=apple-touch-icon sizes=180x180 href=/img/fav/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/fav/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/img/fav/favicon-16x16.png><link rel=manifest href=/img/fav/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><div class="mt-xl header"><header><div class=container><div class="row justify-content-center"><div class=col-auto><a href=/ style=display:contents><h1 class="name text-center">Iossefy</h1></a></div></div><div class="row justify-content-center"><div class="nav justify-content-center"><ul><li class="nav-item justify-content-center mx-auto"><a class=nav-link href=/>~/</a></li><li class="nav-item justify-content-center mx-auto"><a class=nav-link href=/about>About</a></li><li class="nav-item justify-content-center mx-auto"><a class=nav-link href=https://github.com/iossefy>Github</a></li><li class="nav-item justify-content-center mx-auto"><a class=nav-link href=/index.xml>rss</a></li></ul></div></div></div></header></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">Arab Security Cyber WarGames 2022</h1><div class="meta-data meta"><span class="author meta-data" title="Youssef Hesham">Youssef Hesham
<span class="date middot meta-data" title='Mon Aug 8 2022 12:00:00 UTC'>2022-08-08
</span><span class="reading-time middot meta-data">3 min read
</span><a class="middot meta-data" href=/blog/arab-security-cyber-wargames-2022/>Permalink</a><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"><li class=d-inline style=margin-right:.5rem><a class=boxed-tag href=/tags/ctf># ctf</a></li><li class=d-inline style=margin-right:.5rem><a class=boxed-tag href=/tags/writeup># writeup</a></li><li class=d-inline style=margin-right:.5rem><a class=boxed-tag href=/tags/ascwg># ascwg</a></li></ul></div></div><div class="markdown blog-post-content"><h3 id=osp-challenge>OSP Challenge</h3><blockquote><p>Have you heard of OTP? This is OSP (One Secret Password).</p></blockquote><p>given an <code>osp.py</code> that contains the following block of code.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>isPrime</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=n>printable</span><span class=p>,</span> <span class=n>ascii_letters</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=kn>from</span> <span class=nn>secret</span> <span class=kn>import</span> <span class=n>FLAG</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>FLAG</span><span class=p>))</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=k>def</span> <span class=nf>OSP</span><span class=p>(</span><span class=n>plain</span><span class=p>,</span> <span class=n>secret</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>secret</span><span class=p>),</span> <span class=s1>&#39;The length has to be idenntical!&#39;</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=n>ct</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=k>for</span> <span class=n>f</span><span class=p>,</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>FLAG</span><span class=p>,</span> <span class=n>secret</span><span class=p>):</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>        <span class=n>ct</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>f</span> <span class=o>*</span> <span class=n>p</span> <span class=o>+</span> <span class=n>k</span><span class=p>))</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=k>return</span> <span class=n>ct</span><span class=p>,</span> <span class=n>p</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>
</span></span><span class=line><span class=ln>16</span><span class=cl><span class=n>ct</span><span class=p>,</span> <span class=n>p</span> <span class=o>=</span> <span class=n>OSP</span><span class=p>(</span><span class=n>FLAG</span><span class=p>,</span> <span class=n>secret</span><span class=p>)</span>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>
</span></span></code></pre></div><p>And given a text file <code>output.txt</code> that contains the flag encrypted:</p><pre>
5447072546591309544167389173397699795993168970119080464536675615517059887871841
6955492636416595264090666175261678201037431146459748900869908862891014933743799
5614674778794119068603308840271475174331420323045821401907034865225277115190905
7290697100822214312962505509009228957713933852313230775610627362307449388382150
5949879243199738117475148174019025931007923028899303276647753364641711569829134
10307537280472785752809059512737185767802458204994567648277093857055359480126320
7290697100822214312962505509009228957713933852313230775610627362307449388382014
8715316074546095270667822677436319673589070352190528743258680984827295820594564
4357658037273047635333911338718159836794535176095264371629340492413647910297392
4609061385577261921987790839028822904301912205485375777684879366975973751276187
7961106029633452410706184176504330471066939264020194525092064361140318297658489
4106254688968833348680031838407496769287158146705152965573801617851322069318627
8547713842343285746231903010562544295250818999263787805888321735119078593275661
7961106029633452410706184176504330471066939264020194525092064361140318297658510
4106254688968833348680031838407496769287158146705152965573801617851322069318692
4609061385577261921987790839028822904301912205485375777684879366975973751276175
3268243527954785726500433504038619877595901382071448278722005369310235932723134
9637128351661547655065380845242084254449452793287603898795656858222490570849839
7961106029633452410706184176504330471066939264020194525092064361140318297658493
6536487055909571453000867008077239755191802764142896557444010738620471865445985
4022453572867428586462072004970609080118032470241782496888621992997213455659123
4609061385577261921987790839028822904301912205485375777684879366975973751276211
7961106029633452410706184176504330471066939264020194525092064361140318297658707
5363271430489904781949429339960812106824043293655709995851495990662951274212211
7961106029633452410706184176504330471066939264020194525092064361140318297658649
6704089288112380977436786674951015133530054117069637494814369988328689092765262
9553327235560142892847421011805196565280327116824233430110477233368381957190188
4106254688968833348680031838407496769287158146705152965573801617851322069318653
6452685939808166690782907174640352066022677087679526088758831113766363251786487
4273856921171642873115951505281272147625409499631893902944160867559539296637772
2765436831346357153192674503417293742581147323291225466610927620185584250765693
3771050224563214299808192504659946012610655440851671090833083118434887614680427
8547713842343285746231903010562544295250818999263787805888321735119078593275529
4022453572867428586462072004970609080118032470241782496888621992997213455659182
8547713842343285746231903010562544295250818999263787805888321735119078593275562
8547713842343285746231903010562544295250818999263787805888321735119078593275594
8128708261836261935142103843378105849405190616946935462462423610848535524977837
4273856921171642873115951505281272147625409499631893902944160867559539296637945
4525260269475857159769831005591935215132786529022005308999699742121865137616416
4441459153374452397551871172155047525963660852558634840314520117267756523956886
4609061385577261921987790839028822904301912205485375777684879366975973751276006
8463912726241880984013943177125656606081693322800417337203142110264969979616102
10475139512675595277244979179610961146140709557921308585647453106763576707445416
</pre><h3 id=my-approach-solving-the-challange>My approach solving the challange</h3><p>first thing i do is i try to collect as much information as possible from the
given code. by looking at <code>output.txt</code> you can see that most of the lines are
of length 79. while there are two lines that differs from the rest, they have
the length of 80.</p><p>the function <code>OSP(plain, secret)</code> takes byte array (b"array")
and secret (random bytes with the length equals to the flag&rsquo;s length) and
returns the used prime number and <code>ct</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln>1</span><span class=cl><span class=k>def</span> <span class=nf>OSP</span><span class=p>(</span><span class=n>plain</span><span class=p>,</span> <span class=n>secret</span><span class=p>):</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>secret</span><span class=p>),</span> <span class=s1>&#39;The length has to be idenntical!&#39;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=n>ct</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=k>for</span> <span class=n>f</span><span class=p>,</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>FLAG</span><span class=p>,</span> <span class=n>secret</span><span class=p>):</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>        <span class=n>ct</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>f</span> <span class=o>*</span> <span class=n>p</span> <span class=o>+</span> <span class=n>k</span><span class=p>))</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>    <span class=k>return</span> <span class=n>ct</span><span class=p>,</span> <span class=n>p</span>
</span></span></code></pre></div><p>by just looking you can identify the most important part in it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln>1</span><span class=cl><span class=c1>#...</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=k>for</span> <span class=n>f</span><span class=p>,</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>FLAG</span><span class=p>,</span> <span class=n>secret</span><span class=p>):</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=n>ct</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>f</span> <span class=o>*</span> <span class=n>p</span> <span class=o>+</span> <span class=n>k</span><span class=p>))</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1>#...</span>
</span></span></code></pre></div><p>Trying the <code>OSP()</code> function to see how it works.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln>1</span><span class=cl><span class=n>FLAG</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>FLAG</span><span class=p>))</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>ct</span><span class=p>,</span> <span class=n>p</span> <span class=o>=</span> <span class=n>OSP</span><span class=p>(</span><span class=n>FLAG</span><span class=p>,</span> <span class=n>secret</span><span class=p>)</span>
</span></span></code></pre></div><p><code>f</code> is the ord(&lsquo;A&rsquo;), <code>p</code> is a prime number and <code>k</code> is a random byte and it will
result in
<code>56935293674359....900212209796131672</code>
of length 79 now i know where is the 79 chars came from.</p><p>i wrote this function to decrypt needing only the prime number.
By just doing the opposite of what the encrypt function is doing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln>1</span><span class=cl><span class=c1># decrypts and returns ASCII char</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>prime</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=k>return</span> <span class=nb>int</span><span class=p>((</span><span class=n>ctx</span><span class=o>-</span><span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>ctx</span><span class=p>)))</span><span class=o>/</span><span class=n>prime</span><span class=p>)</span>
</span></span></code></pre></div><p>where <code>ctx</code> is <code>f</code>. <code>len(str(ctx))</code> is <code>k</code> and <code>prime</code> is <code>p</code> from the <code>OSP()</code> function</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln>1</span><span class=cl><span class=nb>int</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=p>(</span><span class=n>ctx</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>ctx</span><span class=p>)</span> <span class=p>))</span> <span class=o>/</span> <span class=n>prime</span>
</span></span><span class=line><span class=ln>3</span><span class=cl> <span class=p>)</span>
</span></span></code></pre></div><p>calling this: <code>decrypt(ct[0], p)</code> returns 65 == ord(&lsquo;A&rsquo;) which is our flag!</p><p>the method this encryption function get&rsquo;s its prime number is by <code>p = getPrime(N)</code></p><p>i know the <code>N</code>. so i went on to bruteforce the prime number. and this is my code
to do it.</p><h2 id=solution>Solution</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=c1># as from the OSP() function</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=c1># &gt;&gt; p = getPrime(256)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=n>BIT_LEN</span> <span class=o>=</span> <span class=mi>256</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=c1># decrypts and returns ASCII char</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>prime</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=k>return</span> <span class=nb>int</span><span class=p>((</span><span class=n>ctx</span><span class=o>-</span><span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>ctx</span><span class=p>)))</span><span class=o>/</span><span class=n>prime</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=c1># read output.txt (encrypted data) file</span>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>out</span><span class=p>)):</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        <span class=n>out</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>out</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=c1># I know that the flag starts with ASCWG{</span>
</span></span><span class=line><span class=ln>18</span><span class=cl><span class=n>flag_pfx</span> <span class=o>=</span> <span class=s2>&#34;ASCWG{&#34;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>
</span></span><span class=line><span class=ln>20</span><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>(</span><span class=n>prime</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>out</span><span class=p>)):</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>decrypt</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>out</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>prime</span><span class=p>))</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>    <span class=k>return</span> <span class=n>flag</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>
</span></span><span class=line><span class=ln>26</span><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=n>BIT_LEN</span><span class=p>)</span>
</span></span><span class=line><span class=ln>27</span><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=c1># Bruteforce prime number</span>
</span></span><span class=line><span class=ln>30</span><span class=cl><span class=k>while</span> <span class=n>flag_pfx</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>ret</span><span class=p>:</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=n>BIT_LEN</span><span class=p>)</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>
</span></span><span class=line><span class=ln>34</span><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;prime: </span><span class=si>{</span><span class=n>p</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>35</span><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;flag length: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>36</span><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;flag: </span><span class=si>{</span><span class=n>ret</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><pre>
$ python solve.py
prime: 83614740067651512734468706.....00802220121111201
flag length: 43
flag: ASCWG{Wh47_1f_17's_N07_@_Pr1M3!-f0ffa3657e}
</pre></div></div><hr class=footer-linebreak><div class=container><span class="row justify-content-center meta" id=footer>Copyright Â© 2025 Youssef Hesham
</span><script defer src=/js/custom.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "b3c8a5cb03f0431988de232822b453c3"}'></script></div></div></div></div></body></html>